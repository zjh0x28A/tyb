
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>汕头市教育行业数据</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f5f5f7;
            color: #1d1d1f;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
        }
        .card {
            background-color: #ffffff;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: transform 0.2s ease-in-out;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        h1, h2 {
            color: #000;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            margin-top: 0;
        }
        h1 { font-size: 28px; text-align: center; }
        h2 { font-size: 22px; }
        h3 { font-size: 18px; color: #333; margin-top: 30px; border-bottom: 1px solid #e5e5e5; padding-bottom: 8px; }
        .chart-container {
            position: relative;
            height: 400px;
            width: 100%;
            margin-top: 20px;
        }
        .table-container {
            margin-top: 20px;
            overflow-x: auto;
        }
        .table-container table {
            width: 100%;
            border-collapse: collapse;
        }
        .table-container th, .table-container td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e5e5e5;
            white-space: nowrap;
        }
        .table-container th {
            background-color: #f9f9f9;
            font-weight: 600;
        }
        .grid-2-columns {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
        }
    </style>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f5f5f7;
            color: #1d1d1f;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
        }
        .card {
            background-color: #ffffff;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: transform 0.2s ease-in-out;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        h1, h2 {
            color: #000;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            margin-top: 0;
        }
        h1 { font-size: 28px; }
        h2 { font-size: 22px; }
        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            text-align: center;
        }
        .overview-item {
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 8px;
        }
        .overview-item .label {
            font-size: 14px;
            color: #6e6e73;
        }
        .overview-item .value {
            font-size: 24px;
            font-weight: 600;
            color: #1d1d1f;
        }
        .overview-item .value.negative {
            color: #d64f49;
        }
        .chart-container {
            position: relative;
            height: 400px;
            width: 100%;
        }
        .table-container table {
            width: 100%;
            border-collapse: collapse;
        }
        .table-container th, .table-container td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e5e5e5;
        }
        .table-container th {
            background-color: #f9f9f9;
            font-weight: 600;
        }
        .pie-charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <h1>汕头市教育数据分析报告</h1>
        </div>

        <!-- 1. 汕头市学校总体概况 -->
        <div class="card">
            <h2>一、汕头市学校总体概况</h2>


        <!-- 按学校类型细分 -->

            <h3>1、按学校类型细分</h3>
            <div class="grid-2-columns">
                <div class="chart-container">
                    <canvas id="schoolTypeDistributionChart"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="schoolTypePieChart"></canvas>
                </div>
            </div>
            <div class="table-container">
                <h3>数据详情</h3>
                <table>
                    <thead>
                        <tr><th>大类</th><th>细分类型</th><th>计数</th><th>比例</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>幼儿园</td><td>幼儿园</td><td>1359</td><td>56.13%</td></tr>
                        <tr><td rowspan="9">中小学</td><td>高级中学</td><td>22</td><td>0.91%</td></tr>
                        <tr><td>小学</td><td>712</td><td>29.41%</td></tr>
                        <tr><td>初级中学</td><td>113</td><td>4.67%</td></tr>
                        <tr><td>调整后中等职业学校</td><td>16</td><td>0.66%</td></tr>
                        <tr><td>其他中职机构</td><td>1</td><td>0.04%</td></tr>
                        <tr><td>九年一贯制学校</td><td>103</td><td>4.25%</td></tr>
                        <tr><td>完全中学</td><td>54</td><td>2.23%</td></tr>
                        <tr><td>十二年一贯制学校</td><td>24</td><td>0.99%</td></tr>
                        <tr><td>小学教学点</td><td>1</td><td>0.04%</td></tr>
                        <tr><td><strong>中小学合计</strong></td><td></td><td><strong>1046</strong></td><td><strong>43.21%</strong></td></tr>
                        <tr><td>高校</td><td>高校</td><td>6</td><td>0.25%</td></tr>
                        <tr><td rowspan="3">其它</td><td>其他特教学校</td><td>8</td><td>0.33%</td></tr>
                        <tr><td>培智学校</td><td>1</td><td>0.04%</td></tr>
                        <tr><td>专门学校</td><td>1</td><td>0.04%</td></tr>
                        <tr><td><strong>其它合计</strong></td><td></td><td><strong>10</strong></td><td><strong>0.41%</strong></td></tr>
                        <tr><td><strong>全市合计</strong></td><td></td><td><strong>2421</strong></td><td><strong>100.00%</strong></td></tr>
                    </tbody>
                </table>
            </div>

	<h3>2、按负责类型细分</h3>
            <div class="grid-2-columns">
                <div class="chart-container">
                    <canvas id="schoolDistributionChart"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="schoolManagementPieChart"></canvas>
                </div>
            </div>
            <div class="table-container">
                <h3>数据详情</h3>
                <table>
                    <thead>
                        <tr><th>归属区县</th><th>政企清单制负责</th><th>综合营服负责</th><th>未建档</th><th>合计数量</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>政企客户部</td><td>12</td><td>0</td><td>0</td><td>12</td></tr>
                        <tr><td>龙湖区分公司</td><td>46</td><td>175</td><td>34</td><td>255</td></tr>
                        <tr><td>金平区分公司</td><td>48</td><td>174</td><td>42</td><td>264</td></tr>
                        <tr><td>潮阳区分公司</td><td>444</td><td>208</td><td>58</td><td>710</td></tr>
                        <tr><td>潮南区分公司</td><td>102</td><td>504</td><td>78</td><td>684</td></tr>
                        <tr><td>澄海区分公司</td><td>64</td><td>213</td><td>61</td><td>338</td></tr>
                        <tr><td>濠江区分公司</td><td>35</td><td>86</td><td>15</td><td>136</td></tr>
                        <tr><td>南澳分公司</td><td>6</td><td>13</td><td>0</td><td>19</td></tr>
                        <tr><td>其他</td><td>0</td><td>0</td><td>3</td><td>3</td></tr>
                        <tr><td><strong>共计</strong></td><td><strong>757</strong></td><td><strong>1373</strong></td><td><strong>291</strong></td><td><strong>2421</strong></td></tr>
                    </tbody>
                </table>
            </div>







        </div>

        <!-- 2. 汕头基教网统计 -->
        <div class="card">
            <h2>二、汕头基教网统计</h2>
            <div class="chart-container">
                <canvas id="jijiaoCoverageChart"></canvas>
            </div>
             <div class="chart-container">
                <canvas id="jijiaoRevenueTrendChart"></canvas>
            </div>
            <div class="table-container">
                <h3>数据详情</h3>
                <table>
                    <thead>
                        <tr><th>归属区县</th><th>基教网数量</th><th>学校数量</th><th>覆盖率</th><th>收入 (2025-04)</th><th>收入 (2025-05)</th><th>收入 (2025-06)</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>潮南区分公司</td><td>119</td><td>684</td><td>17.4%</td><td>77471.02</td><td>79768.44</td><td>81948.00</td></tr>
                        <tr><td>潮阳区分公司</td><td>440</td><td>710</td><td>62.0%</td><td>179274.41</td><td>179282.08</td><td>182140.40</td></tr>
                        <tr><td>澄海区分公司</td><td>102</td><td>338</td><td>30.2%</td><td>50523.34</td><td>50619.75</td><td>50898.00</td></tr>
                        <tr><td>濠江区分公司</td><td>67</td><td>134</td><td>50.0%</td><td>50313.69</td><td>51370.37</td><td>50589.68</td></tr>
                        <tr><td>金平区分公司</td><td>127</td><td>264</td><td>48.1%</td><td>96525.17</td><td>95612.70</td><td>95618.50</td></tr>
                        <tr><td>龙湖区分公司</td><td>121</td><td>255</td><td>47.5%</td><td>122784.01</td><td>87136.26</td><td>86484.00</td></tr>
                        <tr><td>南澳分公司</td><td>22</td><td>19</td><td>115.8%</td><td>9325.01</td><td>9658.89</td><td>10540.00</td></tr>
                        <tr><td>政企客户部</td><td>12</td><td>11</td><td>109.1%</td><td>11826.66</td><td>12998.71</td><td>12553.33</td></tr>
                        <tr><td><strong>合计</strong></td><td><strong>1027</strong></td><td><strong>2419</strong></td><td><strong>42.5%</strong></td><td><strong>598043.31</strong></td><td><strong>566447.20</strong></td><td><strong>570771.91</strong></td></tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- 3. 校园安全中心视频监控收编进展 -->
        <div class="card">
            <h2>三、校园安全中心视频监控收编进展</h2>
            <div class="chart-container">
                <canvas id="securityProgressChart"></canvas>
            </div>
            <div class="chart-container">
                <canvas id="securityRateChart"></canvas>
            </div>
            <div class="table-container">
                <h3>数据详情</h3>
                <table>
                    <thead>
                        <tr><th>负责单位</th><th>目标（所）</th><th>收编数</th><th>收编率</th><th>存量基教网待收编数</th><th>视联网发展路数</th><th>视频专线发展数量</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>潮阳区分公司</td><td>618</td><td>318</td><td>51.5%</td><td>63</td><td>-</td><td>17</td></tr>
                        <tr><td>濠江区分公司</td><td>130</td><td>47</td><td>36.2%</td><td>10</td><td>-</td><td>11</td></tr>
                        <tr><td>潮南区分公司</td><td>543</td><td>155</td><td>28.5%</td><td>9</td><td>30</td><td>29</td></tr>
                        <tr><td>南澳分公司</td><td>10</td><td>7</td><td>70.0%</td><td>0</td><td>-</td><td>8</td></tr>
                        <tr><td>政企客户部</td><td>17</td><td>8</td><td>47.1%</td><td>2</td><td>1</td><td>1</td></tr>
                        <tr><td>金平区分公司</td><td>264</td><td>107</td><td>40.5%</td><td>19</td><td>28</td><td>13</td></tr>
                        <tr><td>澄海区分公司</td><td>330</td><td>130</td><td>39.4%</td><td>11</td><td>214</td><td>21</td></tr>
                        <tr><td>龙湖区分公司</td><td>254</td><td>90</td><td>35.4%</td><td>1</td><td>143</td><td>18</td></tr>
                        <tr><td><strong>汕头全市</strong></td><td><strong>2166</strong></td><td><strong>862</strong></td><td><strong>39.8%</strong></td><td><strong>115</strong></td><td><strong>416</strong></td><td><strong>118</strong></td></tr>
                    </tbody>
                </table>
            </div>
        </div>

    </div>

    <script>
        Chart.register(ChartDataLabels);

        const COMMON_CHART_OPTIONS = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { position: 'top' },
                datalabels: {
                    display: true,
                    color: '#000',
                    font: { weight: 'bold', size: 12 },
                    anchor: 'end',
                    align: 'end',
                    offset: -5,
                }
            }
        };
        
        const PIE_CHART_OPTIONS = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { position: 'right' },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.label || '';
                            let value = context.parsed;
                            let percentage = ((value / context.chart.getDatasetMeta(0).total) * 100).toFixed(2) + '%';
                            return `${label}: ${value} (${percentage})`;
                        }
                    }
                },
                datalabels: {
                    display: true,
                    formatter: (value, context) => {
                        const percentage = (value / context.chart.getDatasetMeta(0).total) * 100;
                        return percentage > 5 ? percentage.toFixed(1) + '%' : '';
                    },
                    color: '#ffffff',
                    font: { weight: 'bold' }
                }
            }
        };

        // --- 按学校类型细分 ---
        const schoolTypeData = {
            labels: ['幼儿园', '中小学', '高校', '其它'],
            datasets: [
                { label: '幼儿园', data: [1359, 0, 0, 0], backgroundColor: 'rgba(52, 199, 89, 0.7)', stack: 'Type' },
                { label: '高级中学', data: [0, 22, 0, 0], backgroundColor: 'rgba(0, 122, 255, 0.7)', stack: 'Type' },
                { label: '小学', data: [0, 712, 0, 0], backgroundColor: 'rgba(88, 86, 214, 0.7)', stack: 'Type' },
                { label: '初级中学', data: [0, 113, 0, 0], backgroundColor: 'rgba(255, 149, 0, 0.7)', stack: 'Type' },
                { label: '调整后中等职业学校', data: [0, 16, 0, 0], backgroundColor: 'rgba(255, 45, 85, 0.7)', stack: 'Type' },
                { label: '其他中职机构', data: [0, 1, 0, 0], backgroundColor: 'rgba(175, 82, 222, 0.7)', stack: 'Type' },
                { label: '九年一贯制学校', data: [0, 103, 0, 0], backgroundColor: 'rgba(255, 59, 48, 0.7)', stack: 'Type' },
                { label: '完全中学', data: [0, 54, 0, 0], backgroundColor: 'rgba(10, 132, 255, 0.7)', stack: 'Type' },
                { label: '十二年一贯制学校', data: [0, 24, 0, 0], backgroundColor: 'rgba(48, 209, 88, 0.7)', stack: 'Type' },
                { label: '小学教学点', data: [0, 1, 0, 0], backgroundColor: 'rgba(100, 210, 255, 0.7)', stack: 'Type' },
                { label: '高校', data: [0, 0, 6, 0], backgroundColor: 'rgba(255, 204, 0, 0.7)', stack: 'Type' },
                { label: '其他特教学校', data: [0, 0, 0, 8], backgroundColor: 'rgba(190, 190, 190, 0.7)', stack: 'Type' },
                { label: '培智学校', data: [0, 0, 0, 1], backgroundColor: 'rgba(142, 142, 147, 0.7)', stack: 'Type' },
                { label: '专门学校', data: [0, 0, 0, 1], backgroundColor: 'rgba(174, 174, 178, 0.7)', stack: 'Type' }
            ]
        };
        new Chart(document.getElementById('schoolTypeDistributionChart'), {
            type: 'bar',
            data: schoolTypeData,
            options: { 
                ...COMMON_CHART_OPTIONS, 
                scales: { x: { stacked: true }, y: { stacked: true, beginAtZero: true } }, 
                plugins: { 
                    ...COMMON_CHART_OPTIONS.plugins, 
                    title: { display: true, text: '各类型学校细分分布' },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) { label += ': '; }
                                if (context.parsed.y !== null && context.parsed.y > 0) {
                                    label += context.parsed.y;
                                }
                                return label;
                            }
                        }
                    },
                    datalabels: {
                       display: function(context) {
                          return context.dataset.data[context.dataIndex] > 20; // Display labels only for larger values to avoid clutter
                       },
                       formatter: (value, context) => {
                          return value;
                       }
                    }
                } 
            }
        });

        const schoolTypePieData = {
            labels: ['幼儿园', '中小学', '高校', '其它'],
            datasets: [{ data: [1359, 1046, 6, 10], backgroundColor: ['rgba(52, 199, 89, 0.7)', 'rgba(0, 122, 255, 0.7)', 'rgba(255, 204, 0, 0.7)', 'rgba(142, 142, 147, 0.7)'] }]
        };
        new Chart(document.getElementById('schoolTypePieChart'), {
            type: 'pie',
            data: schoolTypePieData,
            options: { ...PIE_CHART_OPTIONS, plugins: { ...PIE_CHART_OPTIONS.plugins, title: { display: true, text: '学校类型总数占比' } } }
        });

        // --- 1. 汕头市学校总体概况 ---
        const schoolData = {
            labels: ['龙湖区', '金平区', '潮阳区', '潮南区', '澄海区', '濠江区', '南澳', '政企部'],
            datasets: [
                { label: '政企清单制负责', data: [46, 48, 444, 102, 64, 35, 6, 12], backgroundColor: 'rgba(0, 122, 255, 0.7)' },
                { label: '综合营服负责', data: [175, 174, 208, 504, 213, 86, 13, 0], backgroundColor: 'rgba(40, 205, 65, 0.7)' },
                { label: '未建档', data: [34, 42, 58, 78, 61, 15, 0, 0], backgroundColor: 'rgba(255, 149, 0, 0.7)' }
            ]
        };
        new Chart(document.getElementById('schoolDistributionChart'), {
            type: 'bar',
            data: schoolData,
            options: { ...COMMON_CHART_OPTIONS, scales: { x: { stacked: true }, y: { stacked: true } }, plugins: {...COMMON_CHART_OPTIONS.plugins, title: { display: true, text: '各区县学校分布' } } }
        });

        const managementData = {
            labels: ['政企清单制负责', '综合营服负责', '未建档'],
            datasets: [{ data: [757, 1373, 292], backgroundColor: ['rgba(0, 122, 255, 0.7)', 'rgba(40, 205, 65, 0.7)', 'rgba(255, 149, 0, 0.7)'] }]
        };
        new Chart(document.getElementById('schoolManagementPieChart'), {
            type: 'pie',
            data: managementData,
            options: { ...PIE_CHART_OPTIONS, plugins: { ...PIE_CHART_OPTIONS.plugins, title: { display: true, text: '学校负责类型占比' } } }
        });

        // --- 2. 汕头基教网统计 ---
        const jijiaoData = {
            labels: ['潮南区', '潮阳区', '澄海区', '濠江区', '金平区', '龙湖区', '南澳', '政企部'],
            jijiaoCount: [119, 440, 102, 67, 127, 121, 22, 12],
            schoolCount: [684, 710, 338, 134, 264, 255, 19, 11],
            coverage: [17.4, 62.0, 30.2, 50.0, 48.1, 47.5, 115.8, 109.1],
            revApr: [77471, 179274, 50523, 50313, 96525, 122784, 9325, 11826],
            revMay: [79768, 179282, 50619, 51370, 95612, 87136, 9658, 12998],
            revJun: [81948, 182140, 50898, 50589, 95618, 86484, 10540, 12553]
        };
        new Chart(document.getElementById('jijiaoCoverageChart'), {
            type: 'bar',
            data: {
                labels: jijiaoData.labels,
                datasets: [
                    { label: '基教网数量', data: jijiaoData.jijiaoCount, backgroundColor: 'rgba(88, 86, 214, 0.7)', yAxisID: 'y' },
                    { label: '覆盖率 (%)', data: jijiaoData.coverage, type: 'line', borderColor: 'rgba(255, 59, 48, 0.8)', tension: 0.2, yAxisID: 'y1' }
                ]
            },
            options: { 
                ...COMMON_CHART_OPTIONS, 
                plugins: { 
                    ...COMMON_CHART_OPTIONS.plugins, 
                    title: { display: true, text: '各区县基教网数量及覆盖率' },
                    datalabels: {
                        display: true,
                        color: '#000',
                        font: { weight: 'bold', size: 12 },
                        anchor: 'end',
                        align: 'end',
                        offset: -5,
                        formatter: function(value, context) {
                            if (context.dataset.type === 'line') {
                                return value + '%';
                            }
                            return value;
                        }
                    }
                }, 
                scales: { 
                    y: { type: 'linear', display: true, position: 'left', title: {display: true, text: '数量'} }, 
                    y1: { type: 'linear', display: true, position: 'right', title: {display: true, text: '覆盖率 (%)'}, grid: { drawOnChartArea: false } } 
                } 
            }
        });
        new Chart(document.getElementById('jijiaoRevenueTrendChart'), {
            type: 'line',
            data: {
                labels: ['2025-04', '2025-05', '2025-06'],
                datasets: jijiaoData.labels.map((label, i) => ({
                    label: label,
                    data: [jijiaoData.revApr[i], jijiaoData.revMay[i], jijiaoData.revJun[i]],
                    tension: 0.2
                }))
            },
            options: { ...COMMON_CHART_OPTIONS, plugins: { ...COMMON_CHART_OPTIONS.plugins, title: { display: true, text: '各区县基教网今年4月-6月收入趋势 (元)' }, datalabels: {offset: 5, align: 'top'} }, scales: { y: { ticks: { callback: (value) => (value/10000).toFixed(1) + '万' } } } }
        });
        
        // --- 3. 校园安全中心视频监控收编进展 ---
        const securityData = {
             labels: ['潮阳区', '濠江区', '潮南区', '南澳', '政企部', '金平区', '澄海区', '龙湖区'],
             targets: [618, 130, 543, 10, 17, 264, 330, 254],
             actuals: [318, 47, 155, 7, 8, 107, 130, 90],
             rates: [51.5, 36.2, 28.5, 70.0, 47.1, 40.5, 39.4, 35.4]
        };
        new Chart(document.getElementById('securityProgressChart'), {
            type: 'bar',
            data: {
                labels: securityData.labels,
                datasets: [
                    { label: '目标（所）', data: securityData.targets, backgroundColor: 'rgba(200, 200, 200, 0.7)' },
                    { label: '收编数', data: securityData.actuals, backgroundColor: 'rgba(0, 122, 255, 0.7)' }
                ]
            },
            options: { ...COMMON_CHART_OPTIONS, plugins: { ...COMMON_CHART_OPTIONS.plugins, title: { display: true, text: '各单位视频监控收编进展' } } }
        });
         new Chart(document.getElementById('securityRateChart'), {
            type: 'bar',
            data: {
                labels: securityData.labels,
                datasets: [
                    { 
                        label: '收编率 (%)', 
                        data: securityData.rates, 
                        backgroundColor: 'rgba(40, 205, 65, 0.7)',
                    }
                ]
            },
            options: { 
                ...COMMON_CHART_OPTIONS, 
                indexAxis: 'y', 
                plugins: { 
                    ...COMMON_CHART_OPTIONS.plugins, 
                    title: { display: true, text: '各单位视频监控收编率' }, 
                    legend: {display: false}, 
                    datalabels: {
                        anchor: 'start', 
                        align: 'end', 
                        color: '#000',
                        font: { weight: 'bold', size: 12 },
                        offset: 8,
                        formatter: function(value) {
                            return value + '%';
                        }
                    } 
                } 
            }
        });

    </script>
    <div class="container" style="margin-top: 25px;">
        <div class="card">
            <h1 style="text-align:center;">基教客户收入清单月报 (2025年10月)-汕头</h1>
        </div>

        <!-- 总体收入概览 -->
        <div class="card">
            <h2>总体收入概览</h2>
            <div class="overview-grid">
                <div class="overview-item">
                    <div class="label">10月总收入</div>
                    <div class="value">130.97万</div>
                </div>
                <div class="overview-item">
                    <div class="label">2025年累计总收入</div>
                    <div class="value">1492.37万</div>
                </div>
                <div class="overview-item">
                    <div class="label">去年同期总收入</div>
                    <div class="value">1670.97万</div>
                </div>
                <div class="overview-item">
                    <div class="label">累计收入同比增长率</div>
                    <div class="value negative">-10.69%</div>
                </div>
                <div class="overview-item">
                    <div class="label">10月环比增长率</div>
                    <div class="value negative">-12.73%</div>
                </div>
            </div>
        </div>

        <!-- 各项业务收入汇总 -->
        <div class="card">
            <h2>各项业务收入汇总</h2>
            <div class="chart-container">
                <canvas id="businessRevenueChart"></canvas>
            </div>
            <div class="pie-charts-container">
                <div class="chart-container">
                     <canvas id="businessPie2025"></canvas>
                </div>
                <div class="chart-container">
                     <canvas id="businessPie2024"></canvas>
                </div>
            </div>
        </div>

        <!-- 各区县收入详情 -->
        <div class="card">
            <h2>各区县收入详情</h2>
            <div class="chart-container">
                <canvas id="districtRevenueChart"></canvas>
            </div>
        </div>

        <!-- TOP10 客户 -->
        <div class="card">
            <h2>TOP10净增长客户</h2>
            <div class="chart-container">
                <canvas id="topGrowthChart"></canvas>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>客户名称</th>
                            <th>净增长 (万元)</th>
                            <th>主要增长业务</th>
                            <th>业务增长值 (万元)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>汕头市蓬鸥中学</td><td>110.54</td><td>ICT</td><td>110.52</td></tr>
                        <tr><td>汕头市澄海中学</td><td>70.71</td><td>云</td><td>40.93</td></tr>
                        <tr><td>汕头市潮阳区青山初级中学</td><td>18.05</td><td>云</td><td>17.99</td></tr>
                        <tr><td>南澳县教育局</td><td>13.74</td><td>ICT</td><td>13.80</td></tr>
                        <tr><td>汕头市金山中学</td><td>8.46</td><td>固网语音</td><td>2.10</td></tr>
                        <tr><td>汕头市第四中学</td><td>4.87</td><td>ICT</td><td>5.09</td></tr>
                        <tr><td>广东汕头幼儿师范高等专科学校</td><td>4.69</td><td>ICT</td><td>12.80</td></tr>
                        <tr><td>广东省南澳县南澳中学</td><td>4.67</td><td>云</td><td>4.34</td></tr>
                        <tr><td>汕头市潮南区阳光实验学校</td><td>3.45</td><td>组网专线</td><td>1.79</td></tr>
                        <tr><td>汕头市濠江职业技术教育中心</td><td>3.13</td><td>ICT</td><td>3.13</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="card">
            <h2>TOP10净负增长客户</h2>
            <div class="chart-container">
                <canvas id="topLossChart"></canvas>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>客户名称</th>
                            <th>净负增长 (万元)</th>
                            <th>主要负增长业务</th>
                            <th>业务负增长值 (万元)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>汕头市澄海区教育局</td><td>-268.06</td><td>ICT</td><td>-266.99</td></tr>
                        <tr><td>汕头市潮阳区金浦梅西小学</td><td>-34.95</td><td>ICT</td><td>-34.84</td></tr>
                        <tr><td>汕头市澄海实验高级中学</td><td>-23.26</td><td>ICT</td><td>-24.32</td></tr>
                        <tr><td>汕头文化艺术学校</td><td>-18.57</td><td>ICT</td><td>-18.51</td></tr>
                        <tr><td>汕头市潮阳区文光西门小学</td><td>-17.75</td><td>云</td><td>-17.73</td></tr>
                        <tr><td>汕头金南实验学校</td><td>-9.54</td><td>纯宽带</td><td>-6.49</td></tr>
                        <tr><td>汕头市达濠华侨中学</td><td>-8.56</td><td>ICT</td><td>-8.77</td></tr>
                        <tr><td>广东省教育考试院</td><td>-7.73</td><td>组网专线</td><td>-7.73</td></tr>
                        <tr><td>汕头市龙湖区教育局</td><td>-7.66</td><td>组网专线</td><td>-33.87</td></tr>
                        <tr><td>汕头市聿怀中学</td><td>-7.38</td><td>ICT</td><td>-6.83</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="card">
            <h2>TOP10价值客户 (2025)</h2>
            <div class="chart-container">
                <canvas id="topValue2025Chart"></canvas>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>客户名称</th>
                            <th>累计收入 (万元)</th>
                            <th>收入占比</th>
                            <th>最高收入业务</th>
                            <th>最高收入业务金额 (万元)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>汕头市蓬鸥中学</td><td>112.43</td><td>7.53%</td><td>ICT</td><td>110.52</td></tr>
                        <tr><td>汕头市龙湖区教育局</td><td>93.64</td><td>6.27%</td><td>云</td><td>39.52</td></tr>
                        <tr><td>汕头市澄海中学</td><td>85.45</td><td>5.73%</td><td>云</td><td>41.59</td></tr>
                        <tr><td>广东汕头幼儿师范高等专科学校</td><td>26.71</td><td>1.79%</td><td>ICT</td><td>12.80</td></tr>
                        <tr><td>汕头市潮阳区青山初级中学</td><td>18.70</td><td>1.25%</td><td>云</td><td>18.04</td></tr>
                        <tr><td>汕头市潮南区阳光实验学校</td><td>17.27</td><td>1.16%</td><td>其中：移动</td><td>10.19</td></tr>
                        <tr><td>南澳县教育局</td><td>16.21</td><td>1.09%</td><td>ICT</td><td>13.80</td></tr>
                        <tr><td>汕头市金山中学</td><td>14.95</td><td>1.00%</td><td>纯宽带</td><td>5.08</td></tr>
                        <tr><td>汕头市澄海实验高级中学</td><td>12.94</td><td>0.87%</td><td>ICT</td><td>8.21</td></tr>
                        <tr><td>汕头市第一中学</td><td>12.71</td><td>0.85%</td><td>组网专线</td><td>4.34</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="card">
            <h2>TOP10价值客户 (2024)</h2>
            <div class="chart-container">
                <canvas id="topValue2024Chart"></canvas>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>客户名称</th>
                            <th>总收入 (万元)</th>
                            <th>收入占比</th>
                            <th>最高收入业务</th>
                            <th>最高收入业务金额 (万元)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>汕头市澄海区教育局</td><td>271.81</td><td>16.27%</td><td>ICT</td><td>268.06</td></tr>
                        <tr><td>汕头市龙湖区教育局</td><td>101.30</td><td>6.06%</td><td>组网专线</td><td>68.91</td></tr>
                        <tr><td>汕头市澄海实验高级中学</td><td>36.21</td><td>2.17%</td><td>ICT</td><td>32.53</td></tr>
                        <tr><td>汕头市潮阳区金浦梅西小学</td><td>35.38</td><td>2.12%</td><td>ICT</td><td>34.84</td></tr>
                        <tr><td>汕头文化艺术学校</td><td>24.12</td><td>1.44%</td><td>ICT</td><td>18.89</td></tr>
                        <tr><td>广东汕头幼儿师范高等专科学校</td><td>22.02</td><td>1.32%</td><td>互联网专线</td><td>19.36</td></tr>
                        <tr><td>汕头金南实验学校</td><td>18.77</td><td>1.12%</td><td>纯宽带</td><td>12.46</td></tr>
                        <tr><td>汕头市潮阳区文光西门小学</td><td>17.94</td><td>1.07%</td><td>云</td><td>17.73</td></tr>
                        <tr><td>汕头市澄海中学</td><td>14.74</td><td>0.88%</td><td>组网专线</td><td>4.91</td></tr>
                        <tr><td>汕头市潮南区阳光实验学校</td><td>13.82</td><td>0.83%</td><td>其中：移动</td><td>8.93</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

    </div>

    <script>
        Chart.register(ChartDataLabels);
        // --- Utility Functions ---
        const formatValue = (value) => {
            if (Math.abs(value) >= 10000) {
                return (value / 10000).toFixed(2) + '万';
            }
            return value.toFixed(2);
        };

        // --- Chart Configs ---
        const CHART_CONFIG = {
            plugins: {
                legend: { position: 'top' },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) { label += ': '; }
                            if (context.parsed.y !== null) {
                                label += formatValue(context.parsed.y);
                            }
                            return label;
                        }
                    }
                },
                datalabels: {
                    display: true,
                    anchor: 'end',
                    align: 'end',
                    offset: -5,
                    formatter: (value, context) => {
                        return formatValue(value);
                    },
                    color: '#000000',
                    font: { weight: 'bold' }
                }
            },
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    ticks: { callback: (value) => formatValue(value) },
                    beginAtZero: true
                }
            }
        };

        const HORIZONTAL_CHART_CONFIG = {
            indexAxis: 'y',
            plugins: {
                 legend: { display: false },
                 tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) { label += ': '; }
                            if (context.parsed.x !== null) {
                                label += formatValue(context.parsed.x);
                            }
                            return label;
                        }
                    }
                },
                datalabels: {
                    display: true,
                    anchor: 'end',
                    align: function(context) {
                        // For negative values, place the label inside the bar
                        return context.dataset.data[context.dataIndex] < 0 ? 'start' : 'end';
                    },
                    offset: function(context) {
                        // Add more offset for labels inside the bar
                        return context.dataset.data[context.dataIndex] < 0 ? 10 : 5;
                    },
                    formatter: (value, context) => {
                        return formatValue(value);
                    },
                    color: '#1d1d1f',
                    font: { weight: 'bold' }
                }
            },
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: {
                    ticks: { callback: (value) => formatValue(value) },
                    beginAtZero: true
                }
            }
        };
        
        const PIE_CHART_CONFIG = {
             plugins: {
                legend: { position: 'right' },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.label || '';
                            if (label) { label += ': '; }
                            label += formatValue(context.parsed) + ' (' + ((context.parsed / context.chart.getDatasetMeta(0).total) * 100).toFixed(2) + '%)';
                            return label;
                        }
                    }
                },
                datalabels: {
                    display: true,
                    formatter: (value, context) => {
                        const percentage = (value / context.chart.getDatasetMeta(0).total) * 100;
                        if (percentage < 3) return ''; // Hide label for small slices
                        return percentage.toFixed(2) + '%';
                    },
                    color: '#ffffff',
                    font: { weight: 'bold' }
                }
            },
            responsive: true,
            maintainAspectRatio: false
        };

        // --- Chart Implementations ---
        
        // 1. Business Revenue Chart
        const businessData = JSON.parse('[{"name": "ICT", "y2025": 2210929, "y2024": 4114097}, {"name": "云", "y2025": 1821211, "y2024": 1201884}, {"name": "互联网专线", "y2025": 780183.2, "y2024": 656407.8}, {"name": "固网语音", "y2025": 932032.1, "y2024": 961318.5}, {"name": "基本面其他", "y2025": 259667.1, "y2024": 256343.8}, {"name": "纯宽带", "y2025": 1265548, "y2024": 1356448}, {"name": "组网专线", "y2025": 4788445, "y2024": 5226120}, {"name": "翼名片及其他", "y2025": 653794.5, "y2024": 752228.8}, {"name": "移动", "y2025": 1858721, "y2024": 1821345}, {"name": "物联网", "y2025": 844.92, "y2024": 1303.1}]');
        new Chart(document.getElementById('businessRevenueChart'), {
            type: 'bar',
            data: {
                labels: businessData.map(d => d.name),
                datasets: [
                    { label: '2025年收入', data: businessData.map(d => d.y2025), backgroundColor: 'rgba(0, 122, 255, 0.7)' },
                    { label: '2024年收入', data: businessData.map(d => d.y2024), backgroundColor: 'rgba(200, 200, 200, 0.7)' }
                ]
            },
            options: CHART_CONFIG
        });

        // 2. Business Pie Charts
        new Chart(document.getElementById('businessPie2025'), {
            type: 'pie',
            data: {
                labels: businessData.map(d => d.name),
                datasets: [{ label: '2025年收入构成', data: businessData.map(d => d.y2025) }]
            },
            options: { ...PIE_CHART_CONFIG, plugins: { ...PIE_CHART_CONFIG.plugins, title: { display: true, text: '2025年收入构成' } } }
        });
        new Chart(document.getElementById('businessPie2024'), {
            type: 'pie',
            data: {
                labels: businessData.map(d => d.name),
                datasets: [{ label: '2024年收入构成', data: businessData.map(d => d.y2024) }]
            },
            options: { ...PIE_CHART_CONFIG, plugins: { ...PIE_CHART_CONFIG.plugins, title: { display: true, text: '2024年收入构成' } } }
        });

        // 3. District Revenue Chart
        const districtData = JSON.parse('[{"区县": "南澳分公司", "今年累计总收入": 446536.7, "去年同期总收入": 232212.5}, {"区县": "政企客户部", "今年累计总收入": 254544.8, "去年同期总收入": 430455}, {"区县": "潮南区分公司", "今年累计总收入": 2825966, "去年同期总收入": 2797142}, {"区县": "潮阳区分公司", "今年累计总收入": 2789535, "去年同期总收入": 3185150}, {"区县": "澄海区分公司", "今年累计总收入": 2471221, "去年同期总收入": 4669331}, {"区县": "濠江区分公司", "今年累计总收入": 1520998, "去年同期总收入": 1593498}, {"区县": "金平区分公司", "今年累计总收入": 1533033, "去年同期总收入": 1748946}, {"区县": "龙湖区分公司", "今年累计总收入": 3081909, "去年同期总收入": 2052987}]');
        new Chart(document.getElementById('districtRevenueChart'), {
            type: 'bar',
            data: {
                labels: districtData.map(d => d.区县),
                datasets: [
                    { label: '今年累计总收入', data: districtData.map(d => d.今年累计总收入), backgroundColor: 'rgba(0, 122, 255, 0.7)' },
                    { label: '去年同期总收入', data: districtData.map(d => d.去年同期总收入), backgroundColor: 'rgba(200, 200, 200, 0.7)' }
                ]
            },
            options: CHART_CONFIG
        });

        // 4. Top Growth Chart
        const topGrowthData = JSON.parse('[{"name": "汕头市蓬鸥中学", "growth": 1105413}, {"name": "汕头市澄海中学", "growth": 707136.7}, {"name": "汕头市潮阳区青山初级中学", "growth": 180541.7}, {"name": "南澳县教育局", "growth": 137385}, {"name": "汕头市金山中学", "growth": 84649.14}, {"name": "汕头市第四中学", "growth": 48694.84}, {"name": "广东汕头幼儿师范高等专科学校", "growth": 46912.7}, {"name": "广东省南澳县南澳中学", "growth": 46724.62}, {"name": "汕头市潮南区阳光实验学校", "growth": 34529.66}, {"name": "汕头市濠江职业技术教育中心", "growth": 31327.72}]');
        new Chart(document.getElementById('topGrowthChart'), {
            type: 'bar',
            data: {
                labels: topGrowthData.map(d => d.name),
                datasets: [{ label: '净增长', data: topGrowthData.map(d => d.growth), backgroundColor: 'rgba(40, 205, 65, 0.7)' }]
            },
            options: HORIZONTAL_CHART_CONFIG
        });

        // 5. Top Loss Chart
        const topLossData = JSON.parse('[{"name": "汕头市澄海区教育局", "loss": -2680635}, {"name": "汕头市潮阳区金浦梅西小学", "loss": -349479}, {"name": "汕头市澄海实验高级中学", "loss": -232637}, {"name": "汕头文化艺术学校", "loss": -185671}, {"name": "汕头市潮阳区文光西门小学", "loss": -177496}, {"name": "汕头金南实验学校", "loss": -95392.7}, {"name": "汕头市达濠华侨中学", "loss": -85646.4}, {"name": "广东省教育考试院", "loss": -77317.8}, {"name": "汕头市龙湖区教育局", "loss": -76578.2}, {"name": "汕头市聿怀中学", "loss": -73827.3}]');
        new Chart(document.getElementById('topLossChart'), {
            type: 'bar',
            data: {
                labels: topLossData.map(d => d.name),
                datasets: [{ label: '净负增长', data: topLossData.map(d => d.loss), backgroundColor: 'rgba(255, 59, 48, 0.7)' }]
            },
            options: HORIZONTAL_CHART_CONFIG
        });

        // 6. Top Value 2025 Chart
        const topValue2025Data = JSON.parse('[{"name": "汕头市蓬鸥中学", "revenue": 1124342}, {"name": "汕头市龙湖区教育局", "revenue": 936427.4}, {"name": "汕头市澄海中学", "revenue": 854499.6}, {"name": "广东汕头幼儿师范高等专科学校", "revenue": 267066.5}, {"name": "汕头市潮阳区青山初级中学", "revenue": 187006.5}, {"name": "汕头市潮南区阳光实验学校", "revenue": 172685.6}, {"name": "南澳县教育局", "revenue": 162144.5}, {"name": "汕头市金山中学", "revenue": 149528.9}, {"name": "汕头市澄海实验高级中学", "revenue": 129439.2}, {"name": "汕头市第一中学", "revenue": 127139.9}]');
        new Chart(document.getElementById('topValue2025Chart'), {
            type: 'bar',
            data: {
                labels: topValue2025Data.map(d => d.name),
                datasets: [{ label: '2025年累计收入', data: topValue2025Data.map(d => d.revenue), backgroundColor: 'rgba(88, 86, 214, 0.7)' }]
            },
            options: HORIZONTAL_CHART_CONFIG
        });

        // 7. Top Value 2024 Chart
        const topValue2024Data = JSON.parse('[{"name": "汕头市澄海区教育局", "revenue": 2718112}, {"name": "汕头市龙湖区教育局", "revenue": 1013006}, {"name": "汕头市澄海实验高级中学", "revenue": 362076.6}, {"name": "汕头市潮阳区金浦梅西小学", "revenue": 353840.6}, {"name": "汕头文化艺术学校", "revenue": 241179.3}, {"name": "广东汕头幼儿师范高等专科学校", "revenue": 220153.8}, {"name": "汕头金南实验学校", "revenue": 187666.2}, {"name": "汕头市潮阳区文光西门小学", "revenue": 179428.1}, {"name": "汕头市澄海中学", "revenue": 147362.9}, {"name": "汕头市潮南区阳光实验学校", "revenue": 138155.9}]');
        new Chart(document.getElementById('topValue2024Chart'), {
            type: 'bar',
            data: {
                labels: topValue2024Data.map(d => d.name),
                datasets: [{ label: '2024年总收入', data: topValue2024Data.map(d => d.revenue), backgroundColor: 'rgba(175, 82, 222, 0.7)' }]
            },
            options: HORIZONTAL_CHART_CONFIG
        });

    </script>
</body>
</html>
