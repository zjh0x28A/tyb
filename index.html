
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>基教客户收入清单月报 (2025年10月)-汕头</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f5f5f7;
            color: #1d1d1f;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
        }
        .card {
            background-color: #ffffff;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: transform 0.2s ease-in-out;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        h1, h2 {
            color: #000;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            margin-top: 0;
        }
        h1 { font-size: 28px; }
        h2 { font-size: 22px; }
        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            text-align: center;
        }
        .overview-item {
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 8px;
        }
        .overview-item .label {
            font-size: 14px;
            color: #6e6e73;
        }
        .overview-item .value {
            font-size: 24px;
            font-weight: 600;
            color: #1d1d1f;
        }
        .overview-item .value.negative {
            color: #d64f49;
        }
        .chart-container {
            position: relative;
            height: 400px;
            width: 100%;
        }
        .table-container table {
            width: 100%;
            border-collapse: collapse;
        }
        .table-container th, .table-container td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e5e5e5;
        }
        .table-container th {
            background-color: #f9f9f9;
            font-weight: 600;
        }
        .pie-charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <h1 style="text-align:center;">基教客户收入清单月报 (2025年10月)-汕头</h1>
        </div>

        <!-- 总体收入概览 -->
        <div class="card">
            <h2>总体收入概览</h2>
            <div class="overview-grid">
                <div class="overview-item">
                    <div class="label">10月总收入</div>
                    <div class="value">130.97万</div>
                </div>
                <div class="overview-item">
                    <div class="label">2025年累计总收入</div>
                    <div class="value">1492.37万</div>
                </div>
                <div class="overview-item">
                    <div class="label">去年同期总收入</div>
                    <div class="value">1670.97万</div>
                </div>
                <div class="overview-item">
                    <div class="label">累计收入同比增长率</div>
                    <div class="value negative">-10.69%</div>
                </div>
                <div class="overview-item">
                    <div class="label">10月环比增长率</div>
                    <div class="value negative">-12.73%</div>
                </div>
            </div>
        </div>

        <!-- 各项业务收入汇总 -->
        <div class="card">
            <h2>各项业务收入汇总</h2>
            <div class="chart-container">
                <canvas id="businessRevenueChart"></canvas>
            </div>
            <div class="pie-charts-container">
                <div class="chart-container">
                     <canvas id="businessPie2025"></canvas>
                </div>
                <div class="chart-container">
                     <canvas id="businessPie2024"></canvas>
                </div>
            </div>
        </div>

        <!-- 各区县收入详情 -->
        <div class="card">
            <h2>各区县收入详情</h2>
            <div class="chart-container">
                <canvas id="districtRevenueChart"></canvas>
            </div>
        </div>

        <!-- TOP10 客户 -->
        <div class="card">
            <h2>TOP10净增长客户</h2>
            <div class="chart-container">
                <canvas id="topGrowthChart"></canvas>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>客户名称</th>
                            <th>净增长 (万元)</th>
                            <th>主要增长业务</th>
                            <th>业务增长值 (万元)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>汕头市蓬鸥中学</td><td>110.54</td><td>ICT</td><td>110.52</td></tr>
                        <tr><td>汕头市澄海中学</td><td>70.71</td><td>云</td><td>40.93</td></tr>
                        <tr><td>汕头市潮阳区青山初级中学</td><td>18.05</td><td>云</td><td>17.99</td></tr>
                        <tr><td>南澳县教育局</td><td>13.74</td><td>ICT</td><td>13.80</td></tr>
                        <tr><td>汕头市金山中学</td><td>8.46</td><td>固网语音</td><td>2.10</td></tr>
                        <tr><td>汕头市第四中学</td><td>4.87</td><td>ICT</td><td>5.09</td></tr>
                        <tr><td>广东汕头幼儿师范高等专科学校</td><td>4.69</td><td>ICT</td><td>12.80</td></tr>
                        <tr><td>广东省南澳县南澳中学</td><td>4.67</td><td>云</td><td>4.34</td></tr>
                        <tr><td>汕头市潮南区阳光实验学校</td><td>3.45</td><td>组网专线</td><td>1.79</td></tr>
                        <tr><td>汕头市濠江职业技术教育中心</td><td>3.13</td><td>ICT</td><td>3.13</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="card">
            <h2>TOP10净负增长客户</h2>
            <div class="chart-container">
                <canvas id="topLossChart"></canvas>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>客户名称</th>
                            <th>净负增长 (万元)</th>
                            <th>主要负增长业务</th>
                            <th>业务负增长值 (万元)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>汕头市澄海区教育局</td><td>-268.06</td><td>ICT</td><td>-266.99</td></tr>
                        <tr><td>汕头市潮阳区金浦梅西小学</td><td>-34.95</td><td>ICT</td><td>-34.84</td></tr>
                        <tr><td>汕头市澄海实验高级中学</td><td>-23.26</td><td>ICT</td><td>-24.32</td></tr>
                        <tr><td>汕头文化艺术学校</td><td>-18.57</td><td>ICT</td><td>-18.51</td></tr>
                        <tr><td>汕头市潮阳区文光西门小学</td><td>-17.75</td><td>云</td><td>-17.73</td></tr>
                        <tr><td>汕头金南实验学校</td><td>-9.54</td><td>纯宽带</td><td>-6.49</td></tr>
                        <tr><td>汕头市达濠华侨中学</td><td>-8.56</td><td>ICT</td><td>-8.77</td></tr>
                        <tr><td>广东省教育考试院</td><td>-7.73</td><td>组网专线</td><td>-7.73</td></tr>
                        <tr><td>汕头市龙湖区教育局</td><td>-7.66</td><td>组网专线</td><td>-33.87</td></tr>
                        <tr><td>汕头市聿怀中学</td><td>-7.38</td><td>ICT</td><td>-6.83</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="card">
            <h2>TOP10价值客户 (2025)</h2>
            <div class="chart-container">
                <canvas id="topValue2025Chart"></canvas>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>客户名称</th>
                            <th>累计收入 (万元)</th>
                            <th>收入占比</th>
                            <th>最高收入业务</th>
                            <th>最高收入业务金额 (万元)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>汕头市蓬鸥中学</td><td>112.43</td><td>7.53%</td><td>ICT</td><td>110.52</td></tr>
                        <tr><td>汕头市龙湖区教育局</td><td>93.64</td><td>6.27%</td><td>云</td><td>39.52</td></tr>
                        <tr><td>汕头市澄海中学</td><td>85.45</td><td>5.73%</td><td>云</td><td>41.59</td></tr>
                        <tr><td>广东汕头幼儿师范高等专科学校</td><td>26.71</td><td>1.79%</td><td>ICT</td><td>12.80</td></tr>
                        <tr><td>汕头市潮阳区青山初级中学</td><td>18.70</td><td>1.25%</td><td>云</td><td>18.04</td></tr>
                        <tr><td>汕头市潮南区阳光实验学校</td><td>17.27</td><td>1.16%</td><td>其中：移动</td><td>10.19</td></tr>
                        <tr><td>南澳县教育局</td><td>16.21</td><td>1.09%</td><td>ICT</td><td>13.80</td></tr>
                        <tr><td>汕头市金山中学</td><td>14.95</td><td>1.00%</td><td>纯宽带</td><td>5.08</td></tr>
                        <tr><td>汕头市澄海实验高级中学</td><td>12.94</td><td>0.87%</td><td>ICT</td><td>8.21</td></tr>
                        <tr><td>汕头市第一中学</td><td>12.71</td><td>0.85%</td><td>组网专线</td><td>4.34</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="card">
            <h2>TOP10价值客户 (2024)</h2>
            <div class="chart-container">
                <canvas id="topValue2024Chart"></canvas>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>客户名称</th>
                            <th>总收入 (万元)</th>
                            <th>收入占比</th>
                            <th>最高收入业务</th>
                            <th>最高收入业务金额 (万元)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>汕头市澄海区教育局</td><td>271.81</td><td>16.27%</td><td>ICT</td><td>268.06</td></tr>
                        <tr><td>汕头市龙湖区教育局</td><td>101.30</td><td>6.06%</td><td>组网专线</td><td>68.91</td></tr>
                        <tr><td>汕头市澄海实验高级中学</td><td>36.21</td><td>2.17%</td><td>ICT</td><td>32.53</td></tr>
                        <tr><td>汕头市潮阳区金浦梅西小学</td><td>35.38</td><td>2.12%</td><td>ICT</td><td>34.84</td></tr>
                        <tr><td>汕头文化艺术学校</td><td>24.12</td><td>1.44%</td><td>ICT</td><td>18.89</td></tr>
                        <tr><td>广东汕头幼儿师范高等专科学校</td><td>22.02</td><td>1.32%</td><td>互联网专线</td><td>19.36</td></tr>
                        <tr><td>汕头金南实验学校</td><td>18.77</td><td>1.12%</td><td>纯宽带</td><td>12.46</td></tr>
                        <tr><td>汕头市潮阳区文光西门小学</td><td>17.94</td><td>1.07%</td><td>云</td><td>17.73</td></tr>
                        <tr><td>汕头市澄海中学</td><td>14.74</td><td>0.88%</td><td>组网专线</td><td>4.91</td></tr>
                        <tr><td>汕头市潮南区阳光实验学校</td><td>13.82</td><td>0.83%</td><td>其中：移动</td><td>8.93</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

    </div>

    <script>
        Chart.register(ChartDataLabels);
        // --- Utility Functions ---
        const formatValue = (value) => {
            if (Math.abs(value) >= 10000) {
                return (value / 10000).toFixed(2) + '万';
            }
            return value.toFixed(2);
        };

        // --- Chart Configs ---
        const CHART_CONFIG = {
            plugins: {
                legend: { position: 'top' },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) { label += ': '; }
                            if (context.parsed.y !== null) {
                                label += formatValue(context.parsed.y);
                            }
                            return label;
                        }
                    }
                },
                datalabels: {
                    display: true,
                    anchor: 'end',
                    align: 'end',
                    offset: -5,
                    formatter: (value, context) => {
                        return formatValue(value);
                    },
                    color: '#000000',
                    font: { weight: 'bold' }
                }
            },
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    ticks: { callback: (value) => formatValue(value) },
                    beginAtZero: true
                }
            }
        };

        const HORIZONTAL_CHART_CONFIG = {
            indexAxis: 'y',
            plugins: {
                 legend: { display: false },
                 tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) { label += ': '; }
                            if (context.parsed.x !== null) {
                                label += formatValue(context.parsed.x);
                            }
                            return label;
                        }
                    }
                },
                datalabels: {
                    display: true,
                    anchor: 'end',
                    align: function(context) {
                        // For negative values, place the label inside the bar
                        return context.dataset.data[context.dataIndex] < 0 ? 'start' : 'end';
                    },
                    offset: function(context) {
                        // Add more offset for labels inside the bar
                        return context.dataset.data[context.dataIndex] < 0 ? 10 : 5;
                    },
                    formatter: (value, context) => {
                        return formatValue(value);
                    },
                    color: '#1d1d1f',
                    font: { weight: 'bold' }
                }
            },
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: {
                    ticks: { callback: (value) => formatValue(value) },
                    beginAtZero: true
                }
            }
        };
        
        const PIE_CHART_CONFIG = {
             plugins: {
                legend: { position: 'right' },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.label || '';
                            if (label) { label += ': '; }
                            label += formatValue(context.parsed) + ' (' + ((context.parsed / context.chart.getDatasetMeta(0).total) * 100).toFixed(2) + '%)';
                            return label;
                        }
                    }
                },
                datalabels: {
                    display: true,
                    formatter: (value, context) => {
                        const percentage = (value / context.chart.getDatasetMeta(0).total) * 100;
                        if (percentage < 3) return ''; // Hide label for small slices
                        return percentage.toFixed(2) + '%';
                    },
                    color: '#ffffff',
                    font: { weight: 'bold' }
                }
            },
            responsive: true,
            maintainAspectRatio: false
        };

        // --- Chart Implementations ---
        
        // 1. Business Revenue Chart
        const businessData = JSON.parse('[{"name": "ICT", "y2025": 2210929, "y2024": 4114097}, {"name": "云", "y2025": 1821211, "y2024": 1201884}, {"name": "互联网专线", "y2025": 780183.2, "y2024": 656407.8}, {"name": "固网语音", "y2025": 932032.1, "y2024": 961318.5}, {"name": "基本面其他", "y2025": 259667.1, "y2024": 256343.8}, {"name": "纯宽带", "y2025": 1265548, "y2024": 1356448}, {"name": "组网专线", "y2025": 4788445, "y2024": 5226120}, {"name": "翼名片及其他", "y2025": 653794.5, "y2024": 752228.8}, {"name": "移动", "y2025": 1858721, "y2024": 1821345}, {"name": "物联网", "y2025": 844.92, "y2024": 1303.1}]');
        new Chart(document.getElementById('businessRevenueChart'), {
            type: 'bar',
            data: {
                labels: businessData.map(d => d.name),
                datasets: [
                    { label: '2025年收入', data: businessData.map(d => d.y2025), backgroundColor: 'rgba(0, 122, 255, 0.7)' },
                    { label: '2024年收入', data: businessData.map(d => d.y2024), backgroundColor: 'rgba(200, 200, 200, 0.7)' }
                ]
            },
            options: CHART_CONFIG
        });

        // 2. Business Pie Charts
        new Chart(document.getElementById('businessPie2025'), {
            type: 'pie',
            data: {
                labels: businessData.map(d => d.name),
                datasets: [{ label: '2025年收入构成', data: businessData.map(d => d.y2025) }]
            },
            options: { ...PIE_CHART_CONFIG, plugins: { ...PIE_CHART_CONFIG.plugins, title: { display: true, text: '2025年收入构成' } } }
        });
        new Chart(document.getElementById('businessPie2024'), {
            type: 'pie',
            data: {
                labels: businessData.map(d => d.name),
                datasets: [{ label: '2024年收入构成', data: businessData.map(d => d.y2024) }]
            },
            options: { ...PIE_CHART_CONFIG, plugins: { ...PIE_CHART_CONFIG.plugins, title: { display: true, text: '2024年收入构成' } } }
        });

        // 3. District Revenue Chart
        const districtData = JSON.parse('[{"区县": "南澳分公司", "今年累计总收入": 446536.7, "去年同期总收入": 232212.5}, {"区县": "政企客户部", "今年累计总收入": 254544.8, "去年同期总收入": 430455}, {"区县": "潮南区分公司", "今年累计总收入": 2825966, "去年同期总收入": 2797142}, {"区县": "潮阳区分公司", "今年累计总收入": 2789535, "去年同期总收入": 3185150}, {"区县": "澄海区分公司", "今年累计总收入": 2471221, "去年同期总收入": 4669331}, {"区县": "濠江区分公司", "今年累计总收入": 1520998, "去年同期总收入": 1593498}, {"区县": "金平区分公司", "今年累计总收入": 1533033, "去年同期总收入": 1748946}, {"区县": "龙湖区分公司", "今年累计总收入": 3081909, "去年同期总收入": 2052987}]');
        new Chart(document.getElementById('districtRevenueChart'), {
            type: 'bar',
            data: {
                labels: districtData.map(d => d.区县),
                datasets: [
                    { label: '今年累计总收入', data: districtData.map(d => d.今年累计总收入), backgroundColor: 'rgba(0, 122, 255, 0.7)' },
                    { label: '去年同期总收入', data: districtData.map(d => d.去年同期总收入), backgroundColor: 'rgba(200, 200, 200, 0.7)' }
                ]
            },
            options: CHART_CONFIG
        });

        // 4. Top Growth Chart
        const topGrowthData = JSON.parse('[{"name": "汕头市蓬鸥中学", "growth": 1105413}, {"name": "汕头市澄海中学", "growth": 707136.7}, {"name": "汕头市潮阳区青山初级中学", "growth": 180541.7}, {"name": "南澳县教育局", "growth": 137385}, {"name": "汕头市金山中学", "growth": 84649.14}, {"name": "汕头市第四中学", "growth": 48694.84}, {"name": "广东汕头幼儿师范高等专科学校", "growth": 46912.7}, {"name": "广东省南澳县南澳中学", "growth": 46724.62}, {"name": "汕头市潮南区阳光实验学校", "growth": 34529.66}, {"name": "汕头市濠江职业技术教育中心", "growth": 31327.72}]');
        new Chart(document.getElementById('topGrowthChart'), {
            type: 'bar',
            data: {
                labels: topGrowthData.map(d => d.name),
                datasets: [{ label: '净增长', data: topGrowthData.map(d => d.growth), backgroundColor: 'rgba(40, 205, 65, 0.7)' }]
            },
            options: HORIZONTAL_CHART_CONFIG
        });

        // 5. Top Loss Chart
        const topLossData = JSON.parse('[{"name": "汕头市澄海区教育局", "loss": -2680635}, {"name": "汕头市潮阳区金浦梅西小学", "loss": -349479}, {"name": "汕头市澄海实验高级中学", "loss": -232637}, {"name": "汕头文化艺术学校", "loss": -185671}, {"name": "汕头市潮阳区文光西门小学", "loss": -177496}, {"name": "汕头金南实验学校", "loss": -95392.7}, {"name": "汕头市达濠华侨中学", "loss": -85646.4}, {"name": "广东省教育考试院", "loss": -77317.8}, {"name": "汕头市龙湖区教育局", "loss": -76578.2}, {"name": "汕头市聿怀中学", "loss": -73827.3}]');
        new Chart(document.getElementById('topLossChart'), {
            type: 'bar',
            data: {
                labels: topLossData.map(d => d.name),
                datasets: [{ label: '净负增长', data: topLossData.map(d => d.loss), backgroundColor: 'rgba(255, 59, 48, 0.7)' }]
            },
            options: HORIZONTAL_CHART_CONFIG
        });

        // 6. Top Value 2025 Chart
        const topValue2025Data = JSON.parse('[{"name": "汕头市蓬鸥中学", "revenue": 1124342}, {"name": "汕头市龙湖区教育局", "revenue": 936427.4}, {"name": "汕头市澄海中学", "revenue": 854499.6}, {"name": "广东汕头幼儿师范高等专科学校", "revenue": 267066.5}, {"name": "汕头市潮阳区青山初级中学", "revenue": 187006.5}, {"name": "汕头市潮南区阳光实验学校", "revenue": 172685.6}, {"name": "南澳县教育局", "revenue": 162144.5}, {"name": "汕头市金山中学", "revenue": 149528.9}, {"name": "汕头市澄海实验高级中学", "revenue": 129439.2}, {"name": "汕头市第一中学", "revenue": 127139.9}]');
        new Chart(document.getElementById('topValue2025Chart'), {
            type: 'bar',
            data: {
                labels: topValue2025Data.map(d => d.name),
                datasets: [{ label: '2025年累计收入', data: topValue2025Data.map(d => d.revenue), backgroundColor: 'rgba(88, 86, 214, 0.7)' }]
            },
            options: HORIZONTAL_CHART_CONFIG
        });

        // 7. Top Value 2024 Chart
        const topValue2024Data = JSON.parse('[{"name": "汕头市澄海区教育局", "revenue": 2718112}, {"name": "汕头市龙湖区教育局", "revenue": 1013006}, {"name": "汕头市澄海实验高级中学", "revenue": 362076.6}, {"name": "汕头市潮阳区金浦梅西小学", "revenue": 353840.6}, {"name": "汕头文化艺术学校", "revenue": 241179.3}, {"name": "广东汕头幼儿师范高等专科学校", "revenue": 220153.8}, {"name": "汕头金南实验学校", "revenue": 187666.2}, {"name": "汕头市潮阳区文光西门小学", "revenue": 179428.1}, {"name": "汕头市澄海中学", "revenue": 147362.9}, {"name": "汕头市潮南区阳光实验学校", "revenue": 138155.9}]');
        new Chart(document.getElementById('topValue2024Chart'), {
            type: 'bar',
            data: {
                labels: topValue2024Data.map(d => d.name),
                datasets: [{ label: '2024年总收入', data: topValue2024Data.map(d => d.revenue), backgroundColor: 'rgba(175, 82, 222, 0.7)' }]
            },
            options: HORIZONTAL_CHART_CONFIG
        });

    </script>
</body>
</html>
